---
layout: post
title: java35
sitemap: false
hide_last_modified: true
---
# DDD 05 - 표현계층과 응용계층

* toc
{:toc .large-only}

# 표현계층
- 사용자와의 상호작용
- 응용 서비스가 요구하는 객체 생성
    
```java
// Controller단
String curPw = request,getParameter("curPW");
```

- 응용 서비스에 전달할 파라미터가 두 개 이상이면 별도의 클래스 사용 추천(request등)
- `HttpServletRequest`나 `HttpSession` 을 파라미터로 전달하면 안됨
    - 응용 서비스가 표현 영영을 의존하면 안된다!!(상위참조)
        - 테스트 어려워짐
        - 표현영역 변경 시 응용영역도 변경되어야함
- 세션 관리

# 응용계층
- 표현 영역에 의존하지 않음
- 트랜잭션 처리 담당
- 도메인 로직을 넣지 않음
    - 여러 응용계층에서 같은 로직을 구현할 가능성 높아짐
    - 도메인을 이용해서 필요한 `값`을 전달 받아 필요한 기능 구현(직접 만드는게 아니다)
- 웬만하면 표현계층에 애그리거트 자체를 리턴 해주지 말 것. 되도록 필요한 데이터만 넘길것!

> 표현계층(사용자와 상호작용) > 응용계층(받은 값으로 로직만) > 도메인계층(필요한 값을 만들어줌)

## 값 검증

- 여러 값의 검증이 필요 할 때, 하나하나 검증해서 Exception 발생시키는 것 보다는 응용계층에서 에러코드를 모아서 한번에 Exception을 발생시킬 수도 있음
    - ex) List로 에러 모아서 한번에 뿌려줌
- 표현영역에서 `Validator` 사용
- 표현계층: 필수 값, 값 형식, 범위 검증
- 응용서비스: 논리적 오류 검증(데이터 유무)

## 조회 전용 기능

- 단일 쿼리만 실행하는 조회 전용 기능은 서비스가 필요 없다

## 도메인 서비스

- 도메인 영역에 위치한 도메인 로직 표현
    - 계산 로직이나 외부 시스템 연동
    - 여러 애그리거트를 혼합해서 값을 산출
- 응용 서비스에서 도메인 서비스를 전달
- 애그리거트에 주입시키면 안됨
- 도메인 로직만 수행하므로 트랜잭션은 처리하지 않음
- 애그리거트 상태 변경: 응용서비스
- 애그리거트 상태 값 계산: 도메인 서비스
- 다른 도메인 구성요소와 동일한 계층에 위치(Domain계층)
- 도메인 서비스 로직이 고정되지 않은 경우(혹은 외부시스템이나 별도 엔진 이용 시)
    - 도메인 서비스 인터페이스화(Domain계층) / 구현(Infra계층) - DIP
